---
title: "Gov 50 Final Project"
author: "Emma Rogers"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---


## Proposal
Does having a child enhance support of abortion? In this study, I plan to examine the correlation between parental status and support of pro-choice policy. I hypothesize that having a child will increase support for abortion amongst female voters more than male voters. Access to abortion has been a key principle for feminist movements, so it would be likely that female voters would support the choice to have an abortion more than male voters. Female voters who have a child might be more supportive of pro-choice policy if they have a daughter and are concerned for their future, if they did not have access to abortion when they were pregnant, etc.  I will be analyzing data from the Cooperative Congressional Election Study (CCES) that was conducted in 2018. My explanatory variables include gender and child (being a parent/guardian to a child under the age of 18). These are measured through survey questions conducted by YouGov before the 2018 elections. My outcome variable of interest is an answer to a question of whether the voter supports or opposes the proposal to always allow a woman to obtain an abortion as a matter of choice (a measurement of pro-choice). If I observe greater support for this proposal amongst female parents/guardians, this would provide support for my hypothesis. If, on the other hand, I observe greater support for this proposal amongst male voters or no correlation between the child variable and the outcome, this would provide evidence against my hypothesis.

```{r}
load("~/Documents/Gov50/gov50-final-project/cces18_common_vv.RData")
library(tidyverse)
CCES18 <- x
abortion_data <- CCES18 |>
  mutate(
    gender = if_else(gender == 1, "male", "female"),
    educ = case_when(educ == c(1, 2, 3) ~ "Non-College Grad",
                     educ == c(4, 5, 6) ~ "College Grad"),
    party = case_when(pid3 == 1 ~ "Democrat",
                     pid3 == 2 ~ "Republican",
                     pid3 == c(3, 4, 5) ~ "Independent/Other"),
    religion = if_else(religpew == 2, "Roman Catholic", "Non-Catholic"),
    child = if_else(child18 == 1, "Yes", "No"),
    pro_choice = if_else(CC18_321a == 1, 1, 0),
    abortion = if_else(CC18_321a == 1, "Pro-Choice", "Pro-Life")
  ) |>
  select(gender, educ, party, religion, child, abortion, pro_choice) 
```

```{r}
gender_party_plot <- abortion_data |>
  drop_na() |>
  group_by(gender, party) |>
  count(pro_choice) ##|>
##  pivot_wider(
 ##   names_from = party,
 ##   values_from = n
 ## ) ##|>
 ## ggplot(mapping = aes(x = abortion)) +
##  geom_bar()
gender_party_plot

gender_party_plot |>
  ggplot(mapping = aes(x = gender, y = n, fill = party)) +
  geom_col(position = "dodge") +
  labs(
    x = "Gender and Party of Voter",
    y = "Number of Pro-Choice Voters",
    title = "Pro-Choice Voters by Gender and Party"
  )
```

